# 区块链技术与应用

## 课程简介

- 区块链！=bitcoin，bitcoin仅仅时基于区块链技术的一种加密货币而已
- [区块链的数据存储在哪里，如何保证去中心化？ - 知乎 (zhihu.com)](https://www.zhihu.com/question/444956455)
- [区块链动画视频（5）区块链具体是怎样运作的_哔哩哔哩_bilibili](https://www.bilibili.com/video/av23160644/?vd_source=a832c31d95dfdfa3f6655d458c71158e)
- [区块链与分布式系统一致性解决方案_阿狸远翔的博客-CSDN博客_区块链如何保证数据一致性](https://blog.csdn.net/h2453532874/article/details/109244166)

## 比特币

- 比特币是一种不加密的加密货币,交易信息是公开的,但是交易签名是需要进行加密的.

### 密码学原理

- [比特币密码学原理详解 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/110128573)

- 在比特币中使用到密码学的两个主要原理是hash与signature（数字签名）

- hash在密码学中被称为cryptographic hash function,基本特征
  - 特征一：**抗碰撞性**.hash碰撞（collision resistance------hash碰撞是不可避免的，因为hash函数的输入集合远远是大于输出集合的，但是没有什么什么方法人为的去制造hash碰撞，只能通过计算机不停的通过测试输入进行暴力计算-brute-force。）
    - 这个特征作用可以用来检测信息是否被篡改，如果被篡改那么其hash值就会发生改变，所以挖矿其实就是通过大量的并行计算找出能代替真实信息的虚假信息。
    - **人为无法制造hash碰撞时无法进行严格证明，只是实践经验。有些hash函数无法制造有些能制造，比如MD5就能人为的制造hash碰撞。**
  - 特征二：**隐蔽性.**hiding（隐藏，hash计算是单向的，不可逆的，只能通过输入计算输出，不能通过输出反推输入，也就没有泄露原信息，但是前提是输入的空间足够大且分布均匀使得蛮力求解的方法不可行）
  - 两个特征一起可以用来的做什么
    - digital commitment-数字承诺
    - digital equivalent of a sealed envelope-数字化加密的信封
    - 我们可以将类似承诺信息进行加密然后公布出去,这样不用泄露原信息,当需要验证时,再将承诺信息公布出来进行验证.
  - **bitcoin加密的hash函数要求要有第三个性质**
    - ***puzzle friendly***-**谜题友好性.**友好的迷惑,意思就是通过计算找到特定范围的输出值的输入很难,但是一旦找到这个输入后,验证它很容易.(比如像用线性函数作为hash函数,就不可行,因为这是可预测.)
- 比特币中使用的加密hash算法是**SHA-256**(Secure Hash Algorithm,安全hash算法,**此类hash算法满足上面三个特征.**)

####比特币中账本管理方式

- bitcoin是去中心化的方式,相比中心化银行的账本管理方式,我们开户不需要任何相关证明任何机构,**只需要在本地创建自己公钥和私钥对即可,这就是一个账户**
- 对称加密算法(symmetrick encryption algorithm):通信双方使用同一把密钥(encryption key),这把密钥既用于加密又用于解密.**保证双方通信保密的前提是通信双方在通信前能够保证有某种安全通道将密钥传递.所以这种加密方式使得密钥的分发变得困难**。加解密较快，适合大数据进行加解密。
- 非对称加密算法(asymmetrick encryption algorithm):加密使用一对密钥,加密使用的是公钥,解密使用的私钥.这样公钥和密文就能都在公网上进行传输.而自己的私钥只需要保存在本地即可.**公钥就相当于你的银行账号,私钥相当于银行密码**。加解密较慢，适合小数据量。
- **混合加解密，将信息使用对称加密进行加解密，然后使用非对称进行对称的密钥进行加解密，这种方式合理利用了两者的优缺点。**

#### bitcoin中非对称算法的使用-数字签名

- bitcoin虽然是加密货币,但是它的交易信息是不加密的,但是交易人需要进行交易署名,所以需要对署名进行加密处理.
- **签名用的是私钥,验证签名用的是公钥,所以这里和通信时使用非对称加密的方式不同**
- 理论上破解bitcoin这种加密方式,通过计算机随机生成的的公钥比对已知的公钥,如果公钥相同,那么私钥就相同.这样就能窃取.但是实际上不可行,因为产生这种的概率小之又小。
- **注意：产生公私钥的时候要有一个好的随机源，且每次签名的时候也要有好的随机源-因为每次签名都是临时生成的一对密钥，私钥加密，公钥验证，只要有一次不好，就有可能泄露私钥**
- bitcoin中一般先对签名的信息进行取一次hash然后对这个hash值进行签名。

### bitcoin中用到的数据结构

#### hash指针

- 普通指针存储的某个变量（基本数据类型或者结构体）在内存中的起始地址
- 而hash指针除了要保存这个结构体的地址（这个地址应该是一个逻辑地址）外，还要保存这个结构体的hash值。好处在于能够获取到目标内容的hash值，从而通过这个hash值进行验证信息是否被篡改。（什么鸟意思不太懂，只有具体实践后才懂？）

#### 区块链

- bitcoin中最基本的一个数据结构就是区块链
- 就是一个一个区块组成的链表
- 该链表与普通链表的区别：用hash指针代替了普通的指针。
- 每个区块主要包括三个部分：数据、当前区块的hash值、前一个区块的hash值（（这个相当于前一个区块的签名，可以验证前一个区块是否被篡改）。
- ![image-20220927191551297](D:\summary\summary\区块链\img\image-20220927191551297.png)

- **注意，这里的hash值是用整个区块进行运算的**
- **因为有前一个区块的hash值，所以当我们产生新的区块时，你可以选择只存储最近的区块，当需要前面的区块时，就从别人那里去拿取，但是别人可能会恶意篡改区块，所以还需要用所需区块进行hash运算然后与自己存储的区块进行比对。**
- 一般区块链中每个节点都是包含区块链中所有的区块，每个节点之间的区块一致性通过**共识算法**进行同步。

#### Merkle Tree（梅克尔树）

- [梅克尔树_百度百科 (baidu.com)](https://baike.baidu.com/item/梅克尔树/22456281?fr=aladdin)
- [区块链中区块结构里面的梅克尔树是什么意思？ - 币界网 (528btc.com)](https://www.528btc.com/ask/158744238645895.html)
- 梅克尔树是区块链的重要数据结构， 其作用是快速归纳和校验区块数据的存在性和完整性。一般意义上来讲，它是哈希大量聚集数据“块”的一种方式，它依赖于将这些数据“块”分裂成较小单位的数据块，每一个bucket块仅包含几个数据“块”，然后取每个bucket单位数据块再次进行哈希，重复同样的过程，直至剩余的哈希总数仅变为1。
- binary tree

