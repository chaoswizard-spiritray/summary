# GIT

- git是一个**免费的开源的分布式版本控制系统**，可以快速高效地处理从小型到大型的各种项目
- Git [易于学习，](https://git-scm.com/doc)占用[空间小，性能快如闪电](https://git-scm.com/about/small-and-fast)。它超越了SCM工具，如Subversion，CVS，Perforce和ClearCase，具有[廉价的本地分支](https://git-scm.com/about/branching-and-merging)，方便[的暂存区域](https://git-scm.com/about/staging-area)和[多个工作流程](https://git-scm.com/about/distributed)等功能。

## 集中式版本控制器

- CVS、SVN，VSS
- 集中式版本控制器，都有一个单一的集中管理的服务器，保存所有文件的修订版本，而协同工作的人们都通过客户端连到这台服务器，取出最新的文件或者提交更新。
- 好处
  - 每个人可以在一定程度上看到项目的其他人正在做些什么。而管理员也可以轻松的掌控每个人开发者的权限，并且管理一个集中化的版本控制器，要远比在各个客户端上维护本地数据库来的轻松。
  - 所有开发者修改的都是同一套代码
- 坏处
  - 缺点是如果发生单点故障，服务则不可用

## 分布式版本控制器

- GIT、Mercurial、Bazaar、Darcs.....
- 像Git这种分布式版本控制工具，客户端提取的不是最新版本的文件快照，而是把代码仓库完整地镜像下来（本地库）。**这样任何移除协同工作的文件发生故障，事后都可以用其他客户端本地仓库进行恢复。**因为每个客户端的每一次文件提取操作，实际上都是一次对整个文件仓库的完整备份。
- 服务器断网的情况下也可以进行开发（因为版本控制是在本地进行的）
- **每个客户端保存的也都是整个完整的项目**（包含历史记录、更加安全）

## git历史

![20220705085912](.\img\20220705085912.jpg)

## 工作机制和代码托管中心

- 工作区-代码的磁盘目录
- 暂存区-生成历史版本前的临时存储位置，将工作区代码git add后就能将代码推送到暂存区
- 本地库-存储代码的每个历史版本，在暂存区执行git commit后即可生成
- 远程库-代码托管中心，通过git push将本地库代码推送到远程库

### git和代码托管中心

- 代码托管中心是基于网络服务器的远程代码仓库，一般我们简称为远程库
- 局域网：gitlab
- 互联网：github、gitee码云（国内网站）

## git常用命令

[Git 基本操作 | 菜鸟教程 (runoob.com)](https://www.runoob.com/git/git-basic-operations.html)

| 命令                                 | 作用                                                         |
| ------------------------------------ | ------------------------------------------------------------ |
| git config --global user.name 用户名 | 设置用户签名                                                 |
| git log                              | 查看版本详细信息                                             |
| git config --global user.email 邮箱  | 设置用户签名                                                 |
| git init                             | 初始化本地库。要让git管理你的一个本地目录，必须先要用该命令获取目录管理权 |
| git status                           | 查看本地库状态                                               |
| git add 文件名                       | 添加到暂存区                                                 |
| git commit -m "日志信息" 文件名      | 提交到本地库                                                 |
| git reflog                           | 查看历史版本                                                 |
| git reset --hard 版本号              | 版本穿梭，切换head指针当前指向的版本                         |

- 签名的作用发是区分不同操作者身份。用户签名信息在每一个版本的提交信息中能够看到，一次确认本次提交时谁做的。git首次安装必须设置一下用户签名，否则无法提交代码。
- **这里设置用户签名和将来登录GitHub的账号没有任何关系**

## git分支

- 在项目从开发到实际用户使用涉及到多个环境，开发环境、测试环境、生产环境。不同环境下，应该进行不同的管理，将其放在不同的分支上进行管理。

- 在版本控制过程中，同时推进多个任务，每个任务我们可以创建每个任务的单独分支（比如一个项目划分为独立功能模块，每个功能模块可以由不同的程序员进行同时进行开发，可以从拓扑图上进行理解）。使用分支意味着程序员可以把自己的工作从开发主线上分离开，开发自己的分支时，不会影响主线分支的运行。

- **几乎每一种版本控制系统都以某种形式支持分支，一个分支代表一条独立的开发线。**

  **使用分支意味着你可以从开发主线上分离开来，然后在不影响主线的同时继续工作。**

- **Git 分支实际上是指向更改快照的指针。**

- 分支的好处

  - 同时并行推进多个功能呢开发，提高开发效率
  - 各个分支在开发过程中，如果某一个分支开发失败，不会对其他分支由任何影响。失败的分支删除重新开发即可

- 分支的操作

  | 命令                | 作用                         |
  | ------------------- | ---------------------------- |
  | git branch 分支名   | 创建分支                     |
  | git branch -v       | 查看分支详细信息             |
  | git checkout 分支名 | 切换分支                     |
  | git merge 分支名    | 把指定的分支合并到当前分支上 |
  | git branch          | 查看分支                     |

- 每个分支，你可以认为是一个主线的副本，你可以像对主线操作一样进行对副本操作，故副本也可以建立单独的版本。

- 分支合并相当于是将一个分支中与另一个分支的指定版本进行合并后生成一个新的版本。所以当你将其他分支合并到主线分支后，主线分支相当于添加了一个新版本，那么你的分支如果没有其他作用的话，你就可以将其删除。(往往是在分支的生命周期结束时进行合并)

### 分支冲突合并

- 进行合并分支时，两个分支在**同一个文件的同一个位置**有两套完全不同的修改。git无法替我们决定使用哪一个。必须人为决定新代码内容。

  ![20220706101331](D:.\img\20220706101331.jpg)

- HEAD文件指向具体的分支文件

- 分支文件指向具体的版本

## git团队协作

- [git多人协同开发分支合并 - CSDN](https://www.csdn.net/tags/Mtjagg0sMjY2MDktYmxvZwO0O0OO0O0O.html)

- 团队内协作

  | 命令      | 作用                 |
  | --------- | -------------------- |
  | git push  | 将本地库推送到远程库 |
  | git clone | 将远程库拷贝到本地库 |
  | git pull  | 将远程库拉取到本地库 |

- 跨团队协作

  - 不同的团队之间时没有访问权限，所以要先将一个远程库拷贝（fork）到另一个团队的远程库。然后在自己的团队中进行版本控制。当开发完成之后，可以将这个远程库的中的文件合并(merge)到自己远程库中。
  - 当一个团队将自己放方库修改后，需要向在github上原库方发送pull  request，接收方需要对库的pull request进行merge操作

## 远程仓库操作

| 命令                               | 作用                                                     |
| ---------------------------------- | -------------------------------------------------------- |
| git remote -v                      | 查看当前所有远程地址别名                                 |
| git remote add 别名 远程地址       | 起别名                                                   |
| git push 别名 分支                 | 推送本地分支上的内容到远程仓库                           |
| git clone 远程地址                 | 将远程仓库的内容克隆到本地                               |
| git pull 远程库地址别名 远程分支名 | 将远程仓库对于分支最新内容拉下来后与当前本地分支直接合并 |

- 克隆操作会完成三件事：拉取文件、初始化本地仓库、创建别名
- 在团队协作推送代码时，只有同一组的人员才有权限进行推送，所以需要在github上对库进行人员邀请，在具体的库中将setting通过用户名进行邀请。在进行邀请后，你会得到一个邀请函地址，邀请方将邀请函地址给受邀者，受邀者点击同意，然后受邀者就能在自己的github上看到对应的远程库，这样受邀者就能将自己本地上的库推送到对应的团队远程库。

## SSH免密登录

- 先通过git在windows的用户家目录下生成ssh非对称加密算法的密钥。
- ssh-keygen -t rsa -C 179026041@qq.com 然后按三次回车
- 然后复制公钥添加到对应github账户的SSH and GPG keys
- 然后以后对远程库的操作使用ssh协议地址即可

## 整合idea

### 配置git忽略文件

- 在不同的编辑器中，你的项目可能会有不同编辑器独有的文件，这些文件与项目的实际功能无关，不参与服务器上部署运行。把他们忽略掉能够屏蔽IDE工具之间的差异

- 怎么忽略？

  - 创建忽略规则文件xxx.ignore(建议git.ignore)

  - 这个文件存放位置原则上在哪里都可以，为了便于让~/.gitconfig文件引用，建议也放在用户家目录下

    ```ignore
    #Compiled class file
    *.class
    
    #Log file
    *.log
    
    #BlueJ files
    *.ctxt
    
    #Mobile Tools for Java(J2ME)
    .mtj.tmp/
    
    # Package Files #
    *.jar
    *.war
    *.nar
    *.ear
    *.zip
    *.tar.gz
    *.rar
    
    #virtual machine crash logs,see http://www.java.com/en/download/help/error_hotspot.xml
    
    .classpath
    .project
    .settings
    .target
    .idea
    *.iml
    ```

  - 在git.config中引用这个忽略文件

    - [core]

      ​	excludefile=C:/Users/胡远灵/git.ignore

  - 在idea中进行版本控制设置。只需要在设置中的版本控制中指定git.exe安装位置即可。

### idea使用git

- 直接右键你要操作文件或者目录然后执行命令即可。
- 版本切换
  - 在窗口下半部分，有个version control,点击它可以查看所有的版本，只需要右键执行切换命令即可。
- 分支创建和切换
  - 右键项目目录执行git命令或者通过右下角branch进行分支创建。
- 分支合并
  - 正常合并，直接merge即可
  - 冲突合并需要在idea弹出的界面进行手动合并

### idea集成GitHub

- 在setting中的github中添加账号即可。
- 你可以选择填写账号密码进行登录，但是这种方式往往登录不上，和网络有关。
- 你可以选择使用Token进行登录，但是你需要先在GitHub上进行个人登录口令生成
- 分享项目到GitHub上
- 推送，建议通过ssh进行推送
- 拉取