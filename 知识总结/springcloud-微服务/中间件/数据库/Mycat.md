# Mycat

- JDNI(Java Naming and Directory Interface):J2EE中的概念，JDBC用于底层连接数据库，将一个JDBC实例获取到的多个连接组装为一个连接池，这个连接池被称为一个数据源。将多个数据源放在一个大池子中进行管理，就是JDNI。（JDNI就是连接池管理器，连接池就是连接管理器）
  - JNIDI解决应用程序对数据库强依赖，通过配置多个数据源，在不同需要时能够切换访问。JDBC解决连接差异性，统一接口。可以说JDBC为JNDI提供了基础，也可以说JDNI是解决了JDBC衍生出的新问题。（**JDNI在数据库和应用程序中间抽出来了一层，屏蔽数据源差异性**）
- MySQL分布式：[惊！史上最全MySQL分布式概述 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/258608915)
- mycat:一种数据库中间件（连接数据库系统和应用程序之间的程序），将应用程序和数据库解耦（应用程序不直接连接数据库，而是直接访问中间件，**反向代理**），解决高访问高并发对数据库压力（负载均衡），解决读写分离时请求数据不一致。非常像ngnix。
- 是否一定要mycat?
  - 应用程序与数据库解耦？可以通过mybatis访问数据库，并且配置多个数据源，根据需要进行数据源切换。
  - 数据库高并发-也就是数据库集群，以及数据库的负载均衡？我们也可以通过配置不同的数据源，以及在程序中嵌入算法计算进行负载计算，分配负载。
  - 读写分离？通过我们可以通过配置多个数据源，然后判断请求的类型是都还是写，进行不同的数据库进行访问，而数据库层面使用主从复制保证主从数据一致性。对于一主多从的方式我们还是比较好控制的，但是对于多主多从就有些麻烦了，多个主数据库之间如何保证数据的一致性是个麻烦事，这个需要应用程序与数据库之间配合处理。所以这个也是需要应用程序面进行参与控制的。
- 综上数据库中间件不是必须的，所以mycat也不是必须的，正如mybatis和jdbc不是必须的。但是它的复杂性可以让它分离出来作为一个单独程序，复用到各个场景中，提高内聚、降低耦合、提高复用。所以mycat也不过是一种在处理这些问题的一种方案。

## mycat的主要功能

- 读写分离
- 数据分片
  - 垂直拆分：梳理业务-根据业务分别放在数据库的表。
  - 水平拆分：单表数据量过大，影响查找性能，需要分割数据表。
    - 水平分表：根据不同的需求分存储到不同的数据库中。
    - 垂直分表：分割字段。
    - 当然还可以混合分割
- 多数据源整合
  - 屏蔽各种数据源差异

## mycat的原理

- 拦截-分析

  - 拦截sql

  - 分片分析、路由分析、读写分离分析、缓存分析
  - 分析处理之后将sql发送到适当的数据路实体，得到执行结果后如果还需要处理就处理，完成后将其返回给应用程序。

## mycat安装

- rpm
- yum
- 解压后使用：解压拷贝到linux下的/usr/local/
- 解压后编译使用

## mycat配置

- [Mycat配置文件详解_别团等shy哥发育的博客-CSDN博客_mycat 配置文件](https://blog.csdn.net/qq_43753724/article/details/120619779)

- schema.xml:定义逻辑库、表、分片节点等内容

  ```xml
  ```

  

- rule.xml：定义分片规则

- server.xml：定义用户以及系统相关变量，如端口等

